import{c as e,u as a,d as l,g as r}from"./table-51956a81.js";import{bl as t,bT as n,bU as o,bo as u,bV as s,aW as i,bs as d}from"./user-b84445b8.js";import{r as p,a4 as c,k as m,aY as g,W as f,b3 as v,U as h,b1 as _,a2 as b,aG as y,aH as w,ay as C,x as z,a1 as k,X as V,D as x}from"./runtime-core.esm-bundler-9099a418.js";import{G as P}from"./index-2fd6989b.js";import{_ as S}from"./_plugin-vue_export-helper-1b428a4d.js";import"./vue-router-d7411128.js";import"./error-c58402b8.js";const j={total:0,currentPage:1,pageSizes:[10,20,50],pageSize:10,layout:"total, sizes, prev, pager, next, jumper"},U={class:"app-container"},T={class:"toolbar-wrapper"},D={class:"table-wrapper"},q={class:"pager-wrapper"},B=S(c({__name:"index",setup(c){const S=m(!1),{paginationData:B,handleCurrentChange:F,handleSizeChange:G}=((e={})=>{const a=p(Object.assign({...j},e));return{paginationData:a,handleCurrentChange:e=>{a.currentPage=e},handleSizeChange:e=>{a.pageSize=e}}})(),R=m(!1),W=m(null),H=p({username:"",password:""}),I=p({username:[{required:!0,trigger:"blur",message:"请输入用户名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"}]}),O=()=>{var l;null==(l=W.value)||l.validate((l=>{if(!l)return!1;void 0===Y.value?e({username:H.username,password:H.password}).then((()=>{d.success("新增成功"),R.value=!1,J()})):a({id:Y.value,username:H.username}).then((()=>{d.success("修改成功"),R.value=!1,J()}))}))},X=()=>{Y.value=void 0,H.username="",H.password=""},Y=m(void 0),$=m([]),A=m(null),E=p({username:"",phone:""}),J=()=>{S.value=!0,r({currentPage:B.currentPage,size:B.pageSize,username:E.username||void 0,phone:E.phone||void 0}).then((e=>{B.total=e.data.total,$.value=e.data.list})).catch((()=>{$.value=[]})).finally((()=>{S.value=!1}))},K=()=>{1===B.currentPage&&J(),B.currentPage=1},L=()=>{var e;null==(e=A.value)||e.resetFields(),1===B.currentPage&&J(),B.currentPage=1},M=()=>{J()};return g([()=>B.currentPage,()=>B.pageSize],J,{immediate:!0}),(e,a)=>{const r=y("el-input"),p=y("el-form-item"),c=y("el-button"),m=y("el-form"),g=y("el-card"),j=y("el-tooltip"),N=y("el-table-column"),Q=y("el-tag"),Z=y("el-table"),ee=y("el-pagination"),ae=y("el-dialog"),le=w("loading");return C(),f("div",U,[v((C(),h(g,{shadow:"never",class:"search-wrapper"},{default:_((()=>[b(m,{ref_key:"searchFormRef",ref:A,inline:!0,model:E},{default:_((()=>[b(p,{prop:"username",label:"用户名"},{default:_((()=>[b(r,{modelValue:E.username,"onUpdate:modelValue":a[0]||(a[0]=e=>E.username=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),b(p,{prop:"phone",label:"手机号"},{default:_((()=>[b(r,{modelValue:E.phone,"onUpdate:modelValue":a[1]||(a[1]=e=>E.phone=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),b(p,null,{default:_((()=>[b(c,{type:"primary",icon:z(t),onClick:K},{default:_((()=>[k("查询")])),_:1},8,["icon"]),b(c,{icon:z(n),onClick:L},{default:_((()=>[k("重置")])),_:1},8,["icon"])])),_:1})])),_:1},8,["model"])])),_:1})),[[le,S.value]]),v((C(),h(g,{shadow:"never"},{default:_((()=>[V("div",T,[V("div",null,[b(c,{type:"primary",icon:z(o),onClick:a[2]||(a[2]=e=>R.value=!0)},{default:_((()=>[k("新增用户")])),_:1},8,["icon"]),b(c,{type:"danger",icon:z(u)},{default:_((()=>[k("批量删除")])),_:1},8,["icon"])]),V("div",null,[b(j,{content:"下载"},{default:_((()=>[b(c,{type:"primary",icon:z(s),circle:""},null,8,["icon"])])),_:1}),b(j,{content:"刷新表格"},{default:_((()=>[b(c,{type:"primary",icon:z(i),circle:"",onClick:M},null,8,["icon"])])),_:1})])]),V("div",D,[b(Z,{data:$.value},{default:_((()=>[b(N,{type:"selection",width:"50",align:"center"}),b(N,{prop:"username",label:"用户名",align:"center"}),b(N,{prop:"roles",label:"角色",align:"center"},{default:_((e=>["admin"===e.row.roles?(C(),h(Q,{key:0,effect:"plain"},{default:_((()=>[k("admin")])),_:1})):(C(),h(Q,{key:1,type:"warning",effect:"plain"},{default:_((()=>[k(x(e.row.roles),1)])),_:2},1024))])),_:1}),b(N,{prop:"phone",label:"手机号",align:"center"}),b(N,{prop:"email",label:"邮箱",align:"center"}),b(N,{prop:"status",label:"状态",align:"center"},{default:_((e=>[e.row.status?(C(),h(Q,{key:0,type:"success",effect:"plain"},{default:_((()=>[k("启用")])),_:1})):(C(),h(Q,{key:1,type:"danger",effect:"plain"},{default:_((()=>[k("禁用")])),_:1}))])),_:1}),b(N,{prop:"createTime",label:"创建时间",align:"center"}),b(N,{fixed:"right",label:"操作",width:"150",align:"center"},{default:_((e=>[b(c,{type:"primary",text:"",bg:"",size:"small",onClick:a=>{return l=e.row,Y.value=l.id,H.username=l.username,H.password=l.password,void(R.value=!0);var l}},{default:_((()=>[k("修改")])),_:2},1032,["onClick"]),b(c,{type:"danger",text:"",bg:"",size:"small",onClick:a=>{return r=e.row,void P.confirm(`正在删除用户：${r.username}，确认删除？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{l(r.id).then((()=>{d.success("删除成功"),J()}))}));var r}},{default:_((()=>[k("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),V("div",q,[b(ee,{background:"",layout:z(B).layout,"page-sizes":z(B).pageSizes,total:z(B).total,"page-size":z(B).pageSize,currentPage:z(B).currentPage,onSizeChange:z(G),onCurrentChange:z(F)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])),_:1})),[[le,S.value]]),b(ae,{modelValue:R.value,"onUpdate:modelValue":a[6]||(a[6]=e=>R.value=e),title:void 0===Y.value?"新增用户":"修改用户",onClose:X,width:"30%"},{footer:_((()=>[b(c,{onClick:a[5]||(a[5]=e=>R.value=!1)},{default:_((()=>[k("取消")])),_:1}),b(c,{type:"primary",onClick:O},{default:_((()=>[k("确认")])),_:1})])),default:_((()=>[b(m,{ref_key:"formRef",ref:W,model:H,rules:I,"label-width":"100px","label-position":"left"},{default:_((()=>[b(p,{prop:"username",label:"用户名"},{default:_((()=>[b(r,{modelValue:H.username,"onUpdate:modelValue":a[3]||(a[3]=e=>H.username=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),b(p,{prop:"password",label:"密码"},{default:_((()=>[b(r,{modelValue:H.password,"onUpdate:modelValue":a[4]||(a[4]=e=>H.password=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-515ac068"]]);export{B as default};

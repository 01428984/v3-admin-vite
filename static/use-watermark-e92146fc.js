import{J as B}from"./element-a4dc66a7.js";import{r as $,s as L,c as I,z as V,H,ah as W,l as T,m as G,p as M,V as i,P as u,u as _,T as y}from"./vue-2207505e.js";import{_ as O}from"./index-48471224.js";import"./vxe-51e6f8a7.js";const R={color:"#c0c4cc",opacity:.5,size:"16px",family:"serif",angle:-20,width:200,height:150},P=$(document.body);function z(l=P){let d;const a=L(null),k=e=>{const{color:t,opacity:r,size:o,family:g,angle:C,width:h,height:w}=d??R,p=document.createElement("canvas");p.width=h,p.height=w;const s=p.getContext("2d");return s&&(s.fillStyle=t,s.globalAlpha=r,s.font=o+" "+g,s.rotate(Math.PI/180*C),s.clearRect(0,0,h,w),s.fillText(e,0,w/2)),p.toDataURL()},f=()=>{!l.value||!a.value||(l.value.removeChild(a.value),a.value=null,b(l.value))};function v(e={}){a.value&&(e.width&&(a.value.style.width=`${e.width}px`),e.height&&(a.value.style.height=`${e.height}px`),e.text&&(a.value.style.background=`url(${k(e.text)}) left top repeat`))}const x=e=>{if(!l.value)return;if(a.value){v({text:e});return}const t=document.createElement("div");a.value=t,t.style.pointerEvents="none",t.style.top="0",t.style.left="0",t.style.position="absolute",t.style.zIndex="100000";const{clientWidth:r,clientHeight:o}=l.value;v({width:r,height:o,text:e}),l.value.appendChild(t)},n=(e,t={})=>{l.value&&(l.value.style.position="relative",d={...R,...t},x(e),m(l.value),I()&&V(f))},c=(e,t)=>{e.forEach(r=>{switch(r.type){case"childList":r.removedNodes.forEach(o=>{o===a.value&&t.appendChild(a.value)});break;case"attributes":a.value.style.display==="none"&&(a.value.style.display="block");break}})},m=e=>{if(e._observer||!a.value)return;const t={attributes:!0,childList:!0},r=B(g=>{const{clientWidth:C,clientHeight:h}=e;v({width:C,height:h}),c(g,e)},500),o=new MutationObserver(r);o.observe(e,t),e._observer=o},b=e=>{var t;(t=e._observer)==null||t.disconnect(),e._observer=void 0};return{setWatermark:n,clear:f}}const U={class:"app-container"},A=H({__name:"use-watermark",setup(l){const d=$(null),{setWatermark:a,clear:k}=z(d),{setWatermark:f,clear:v}=z();return(x,n)=>{const c=W("el-button"),m=W("el-button-group");return T(),G("div",U,[M("div",{ref_key:"localRef",ref:d,class:"local"},null,512),i(m,null,{default:u(()=>[i(c,{type:"primary",onClick:n[0]||(n[0]=b=>_(a)("局部水印",{color:"#409eff"}))},{default:u(()=>[y("创建局部水印")]),_:1}),i(c,{type:"primary",onClick:_(k)},{default:u(()=>[y("清除局部水印")]),_:1},8,["onClick"])]),_:1}),i(m,null,{default:u(()=>[i(c,{type:"primary",onClick:n[1]||(n[1]=b=>_(f)("全局水印"))},{default:u(()=>[y("创建全局水印")]),_:1}),i(c,{type:"primary",onClick:_(v)},{default:u(()=>[y("清除全局水印")]),_:1},8,["onClick"])]),_:1})])}}});const j=O(A,[["__scopeId","data-v-3a15d249"]]);export{j as default};
